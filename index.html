<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Interactive Dussehra Game</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body, html {
    margin: 0; padding: 0;
    background: #f9f0e9;
    width: 100vw; height: 100vh;
    font-family: Arial, sans-serif;
    overflow: hidden;
  }
  #game-container {
    position: relative;
    width: 100vw; height: 100vh;
    touch-action: manipulation;
    user-select: none;
  }
  #message {
    width: 90%;
    margin: 4vh auto 0 auto;
    font-size: 3vw;
    color: #d35400;
    text-align: center;
    text-shadow: 1px 1px 4px #fff;
    white-space: pre-line;
    z-index: 10;
  }
  #ravana {
    position: absolute;
    top: 15vh;
    left: -9vw;
    height: 40vh;
    max-width: 70vw;
    object-fit: contain;
    pointer-events: none;
    user-select: none;
    transition: height 0.3s, max-width 0.3s, top 0.3s, left 0.3s;
  }
  #click-here {
    position: absolute;
    bottom: 14vh;
    right: 42vw;
    font-size: 4vw;
    color: #d35400;
    font-weight: bold;
    user-select: none;
    cursor: pointer;
    text-shadow: 1px 1px 3px #fff;
    white-space: nowrap;
    z-index: 20;
  }
  #girl, #girl_after {
    position: absolute;
    bottom: 8vh;
    right: 10vw;
    height: 20vh;
    max-width: 30vw;
    object-fit: contain;
    pointer-events: all;
    user-select: none;
    cursor: pointer;
  }
  #girl_after { display: none; }
  #arrow {
    position: absolute;
    bottom: 8vh;
    right: 25vw;
    height: 6vh;
    max-width: 6vw;
    pointer-events: none;
    user-select: none;
    z-index: 5;
    display: none;
    transition: bottom 1.3s linear, right 1.3s linear;
  }
  .arrow-trail-particle {
    position: absolute;
    background-color: rgba(255, 204, 0, 0.8);
    border-radius: 50%;
    pointer-events: none;
    opacity: 0;
    animation: trail-fade 1s forwards;
  }
  @keyframes trail-fade {
    from { opacity: 1; transform: scale(1); }
    to { opacity: 0; transform: scale(0); }
  }

  /* New CSS for the fireworks display */
  .firework {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    z-index: 100;
  }
  .firework .spark {
    position: absolute;
    background-color: transparent;
    border-radius: 50%;
    animation-name: spark-burst;
    animation-timing-function: ease-out;
    animation-fill-mode: forwards;
  }

  @keyframes spark-burst {
    from {
      transform: scale(0) translate(0, 0);
      opacity: 1;
    }
    to {
      transform: scale(1) translate(var(--x), var(--y));
      opacity: 0;
    }
  }

  /* Different colors and sizes for sparks */
  .spark.red { background-color: #ff0000; width: 4px; height: 4px; }
  .spark.yellow { background-color: #ffff00; width: 6px; height: 6px; }
  .spark.blue { background-color: #0000ff; width: 5px; height: 5px; }

  @media (min-width: 700px), (orientation: landscape) {
    #ravana {
      top: 35vh;
      left: 15vw;
      height: 60vh;
      max-width: 30vw;
    }
    #click-here {
      bottom: 18vh;
      right: 55vw;
      font-size: 2vw;
    }
    #girl, #girl_after {
      bottom: 10vh;
      right: 15vw;
      height: 30vh;
      max-width: 30vw;
    }
    #arrow {
      bottom: 10vh;
      right: 32vw;
      height: 8vh;
      max-width: 5vw;
    }
  }
</style>
</head>
<body>
<div id="game-container">
  <div id="message">
    Hey Sweetie, today you’re not just burning Ravana—
    you’re burning your worries, fears, and all that weighs you down.
    Stand tall, take that arrow of courage, and set your spirit free.
    This is your new beginning.
  </div>
  <img id="ravana" src="ravan-animated.png" alt="Ravana" />
  <div id="click-here">Click Here →</div>
  <img id="girl" src="archer.png" alt="Girl before shot" />
  <img id="girl_after" src="archerwithout aero.jpg" alt="Girl after shot" />
  <img id="arrow" src="aero.jpg" alt="Arrow" />

  <audio id="fireworks-sound" src="https://gfxsounds.com/wp-content/uploads/2024/01/Fireworks-display-explosions-short-2.mp3" preload="auto"></audio>
</div>
<script>
  const ravana = document.getElementById('ravana');
  const girl = document.getElementById('girl');
  const girl_after = document.getElementById('girl_after');
  const arrow = document.getElementById('arrow');
  const message = document.getElementById('message');
  const clickHere = document.getElementById('click-here');
  const fireworksSound = document.getElementById('fireworks-sound');
  let arrowTrailInterval;

  // New function to create a single firework burst
  function createFirework(x, y) {
    const firework = document.createElement('div');
    firework.classList.add('firework');
    document.body.appendChild(firework);

    const colors = ['red', 'yellow', 'blue'];
    const numSparks = 80;

    for (let i = 0; i < numSparks; i++) {
      const spark = document.createElement('div');
      const color = colors[Math.floor(Math.random() * colors.length)];
      spark.classList.add('spark', color);

      const angle = Math.random() * 2 * Math.PI;
      const distance = Math.random() * 150 + 50;
      const duration = Math.random() * 1 + 1.5;
      const delay = Math.random() * 0.5;

      const endX = distance * Math.cos(angle);
      const endY = distance * Math.sin(angle);

      spark.style.left = `${x}px`;
      spark.style.top = `${y}px`;
      spark.style.setProperty('--x', `${endX}px`);
      spark.style.setProperty('--y', `${endY}px`);
      spark.style.animationDuration = `${duration}s`;
      spark.style.animationDelay = `${delay}s`;

      firework.appendChild(spark);
    }

    setTimeout(() => {
      firework.remove();
    }, 2500);
  }

  // Function to create multiple firework bursts
  function fireOffFireworks() {
    const numBursts = 15;
    for (let i = 0; i < numBursts; i++) {
      const delay = i * 400 + Math.random() * 200;
      setTimeout(() => {
        const x = Math.random() * window.innerWidth;
        const y = Math.random() * window.innerHeight * 0.5;
        createFirework(x, y);
      }, delay);
    }
  }

  // New function to create the arrow trail
  function createArrowTrail() {
    const arrowRect = arrow.getBoundingClientRect();
    const trailParticle = document.createElement('div');
    trailParticle.classList.add('arrow-trail-particle');
    trailParticle.style.width = `${Math.random() * 5 + 3}px`;
    trailParticle.style.height = trailParticle.style.width;
    trailParticle.style.left = `${arrowRect.left + arrowRect.width / 2}px`;
    trailParticle.style.top = `${arrowRect.top + arrowRect.height / 2}px`;
    document.body.appendChild(trailParticle);
    setTimeout(() => {
      trailParticle.remove();
    }, 1000);
  }

  function animateShot() {
    // THIS IS THE FIX: Play the sound immediately on the user's click
    fireworksSound.play();

    girl.style.display = 'none';
    girl_after.style.display = 'block';
    arrow.style.display = 'block';
    clickHere.style.display = 'none';

    const arrowStartRight = parseFloat(window.getComputedStyle(arrow).right);
    const arrowStartBottom = parseFloat(window.getComputedStyle(arrow).bottom);

    const arrowEndRight = window.innerWidth * 0.75;
    const arrowEndBottom = window.innerHeight * 0.75;

    // Start the arrow trail animation
    arrowTrailInterval = setInterval(createArrowTrail, 20);

    arrow.style.right = arrowStartRight + 'px';
    arrow.style.bottom = arrowStartBottom + 'px';

    setTimeout(() => {
      arrow.style.right = arrowEndRight + 'px';
      arrow.style.bottom = arrowEndBottom + 'px';
    }, 40);

    setTimeout(() => {
      arrow.style.display = 'none';
      ravana.src = 'ravan-burned.png';
      
      message.textContent = `You did it, Sweetie!\nYou lit up your path by letting go of what held you back.\nHappy Dussehra, my dear!\nMay the days ahead be filled with light, laughter, big dreams, and a heart full of joy.\nTogether, we celebrate your strength and every beautiful victory.`;
      
      const ravanaRect = ravana.getBoundingClientRect();
      const ravanaX = ravanaRect.left + ravanaRect.width / 2;
      const ravanaY = ravanaRect.top + ravanaRect.height / 2;

      fireOffFireworks();
      
      // Stop the arrow trail animation
      clearInterval(arrowTrailInterval);
      
    }, 1300);
  }

  girl.addEventListener('click', animateShot);
  girl.addEventListener('touchend', animateShot);
</script>
</body>
</html>
